---
title: 第3节 分部积分法
weight: 3
---
## 一、基础题

### 1 求下列不定积分

（1）$\displaystyle \int x\cos\frac{x}{2}\,dx$

解答：

令$\displaystyle u=x,\; dv=\cos\frac{x}{2}dx$。
则$\displaystyle du=dx,\; v=2\sin\frac{x}{2}$。
$$\int x\cos\frac{x}{2}dx=x\cdot2\sin\frac{x}{2}-\int 2\sin\frac{x}{2}dx$$
$$=2x\sin\frac{x}{2}+4\cos\frac{x}{2}+C.$$

（2）$\displaystyle \int 2xe^{-2x}\,dx$

解答：

设$\displaystyle u=2x,\; dv=e^{-2x}dx$。
则$\displaystyle du=2dx,\; v=-\frac12 e^{-2x}$。
$$\int 2xe^{-2x}dx=-x e^{-2x}+\int e^{-2x}dx$$
$$=-xe^{-2x}-\frac12 e^{-2x}+C$$
$$=-(x+\tfrac12)e^{-2x}+C.$$

（3）$\displaystyle \int \ln x\,dx$

解答：

$$\int\ln x\,dx=x\ln x-x+C.$$

（4）$\displaystyle \int x^{2}\ln 2x\,dx$

解答：

$\ln 2x=\ln 2+\ln x$，故
$$\int x^{2}\ln 2x\,dx=\ln2\int x^{2}dx+\int x^{2}\ln x\,dx.$$
对后者分部积分：
设 $u=\ln x,\; dv=x^{2}dx$，则
$$\int x^{2}\ln x\,dx=\frac{x^{3}}{3}\ln x-\int\frac{x^{3}}{3}\cdot\frac1x dx$$
$$=\frac{x^{3}}{3}\ln x-\frac13\int x^{2}dx$$
$$=\frac{x^{3}}{3}\ln x-\frac{x^{3}}{9}.$$
故
$$\int x^{2}\ln 2x\,dx=\frac{\ln2}{3}x^{3}+\frac{x^{3}}{3}\ln x-\frac{x^{3}}{9}+C.$$

（5）$\displaystyle \int \ln(1+x^{2})\,dx$

解答：

分部积分：$u=\ln(1+x^{2}), dv=dx$。
$$\int \ln(1+x^{2})dx=x\ln(1+x^{2})-\int x\cdot\frac{2x}{1+x^{2}}dx$$
$$=x\ln(1+x^{2})-2\int \frac{x^{2}}{1+x^{2}}dx.$$
$$\frac{x^{2}}{1+x^{2}}=1-\frac1{1+x^{2}}.$$
$$= x\ln(1+x^{2})-2\left( x-\arctan x\right)+C.$$

（6）$\displaystyle \int \sec^{3}x\,dx$

解答：

$$\int \sec^{3}x dx=\frac12\sec x\tan x+\frac12\ln|\sec x+\tan x|+C.$$

（7）$\displaystyle \int x^{2}\arctan x\,dx$

解答：

分部积分：$u=\arctan x,\; dv=x^{2}dx$。
$$\int x^{2}\arctan x dx=\frac{x^{3}}{3}\arctan x-\int\frac{x^{3}}{3}\cdot\frac1{1+x^{2}}dx.$$
$$\frac{x^{3}}{1+x^{2}}=x-\frac{x}{1+x^{2}}.$$
故：
$$=\frac{x^{3}}{3}\arctan x-\frac13\int x dx+\frac13 \int \frac{x}{1+x^{2}}dx$$
$$=\frac{x^{3}}{3}\arctan x-\frac{x^{2}}{6}+\frac{1}{6}\ln(1+x^{2})+C.$$

（8）$\displaystyle \int \frac{\arctan x}{x^{3}}\,dx$

解答：

分部积分：$u=\arctan x,\; dv=x^{-3}dx$。
$$v=-\frac12 x^{-2}$$
$$\int \frac{\arctan x}{x^{3}}dx=-\frac12 \frac{\arctan x}{x^{2}}+\frac12\int \frac{1}{x^{2}(1+x^{2})}dx.$$
部分分式：
$$\frac{1}{x^{2}(1+x^{2})}=\frac{1}{x^{2}}-\frac{1}{1+x^{2}}.$$
故
$$=\;-\frac12\frac{\arctan x}{x^{2}}+\frac12\left(-\frac1x-\arctan x\right)+C.$$

（9）$\displaystyle \int \cos(\ln x)\,dx$

解答：

令 $t=\ln x$，则 $dx=e^{t}dt=x dt$。
$$\int \cos(\ln x)dx=\int e^{t}\cos t\,dt$$
$$=\frac12 e^{t}(\sin t+\cos t)+C$$
$$=\frac{x}{2}(\sin(\ln x)+\cos(\ln x))+C.$$

（10）$\displaystyle \int e^{\sqrt{2x+3}}\,dx$

解答：

令 $u=\sqrt{2x+3}$，则 $u^{2}=2x+3$，$x=\frac{u^{2}-3}{2}$，且
$$dx=u du.$$
$$\int e^{u} u\, du =u e^{u}-e^{u}+C=e^{u}(u-1)+C.$$
$$=e^{\sqrt{2x+3}}\left(\sqrt{2x+3}-1\right)+C.$$

## 二、提高题

### 2 求下列不定积分

（1）$\displaystyle \int (\ln x)^{2}dx$

解答：

$$\int (\ln x)^{2}dx=x(\ln x)^{2}-2x\ln x+2x+C.$$

（2）$\displaystyle \int \frac{\ln^{3} x}{x^{2}}dx$

解答：

令 $u=\ln x$，$dx=x du$，写成：
$$\int \frac{u^{3}}{x}dx=\int u^{3}du=\frac{u^{4}}{4}+C=\frac{(\ln x)^{4}}{4}+C.$$

（3）$\displaystyle \int x^{2}\cos^{2}\frac{x}{2}\,dx$

解答：

$$\cos^{2}\frac{x}{2}=\frac{1+\cos x}{2}$$
$$=\frac12\int x^{2}dx+\frac12 \int x^{2}\cos x dx.$$
对第二项分部两次，得最终结果：
$$=\frac{x^{3}}{6}+\frac12\left(x^{2}\sin x+2x\cos x-2\sin x\right)+C.$$

（4）$\displaystyle \int (\arcsin x)^{2}dx$

解答：

设 $u=(\arcsin x)^{2}, dv=dx$。
$$\int (\arcsin x)^{2}dx=x(\arcsin x)^{2}-2\int x\frac{\arcsin x}{\sqrt{1-x^{2}}}dx.$$
令 $t=1-x^{2}$，可化为：
$$=x(\arcsin x)^{2}+\arcsin x\sqrt{1-x^{2}}-x+C.$$

（5）$\displaystyle \int \ln(x+\sqrt{1+x^{2}})\,dx$

解答：

$$\int \ln(x+\sqrt{1+x^{2}})dx= x\ln(x+\sqrt{1+x^{2}})-\sqrt{1+x^{2}}+C.$$

（6）$\displaystyle \int e^{x}\sin^{2}x\,dx$

解答：

$$\sin^{2}x=\frac{1-\cos2x}{2}$$
$$=\frac12\int e^{x}dx-\frac12\int e^{x}\cos2x\,dx.$$
第二项用待定系数法求出：
$$\int e^{x}\cos2x dx=\frac{e^{x}}{5}(\cos2x+2\sin2x).$$
故：
$$\int e^{x}\sin^{2}x dx=\frac12 e^{x}-\frac{e^{x}}{10}(\cos2x+2\sin2x)+C.$$

（7）$\displaystyle \int \frac{\ln(1+e^{x})}{e^{x}}dx$

解答：

令 $t=e^{x}$，$dt=e^{x}dx$。
$$\int \frac{\ln(1+t)}{t}\,dt$$
积分结果：
$$=\frac12\ln^{2}(1+t)+C=\frac12\ln^{2}(1+e^{x})+C.$$

（8）$\displaystyle \int e^{2x}( \tan x+1)^{2} dx$

解答：

展开：
$$(\tan x+1)^{2}=\tan^{2}x+2\tan x+1=\sec^{2}x+2\tan x.$$
$$\int e^{2x}(\sec^{2}x+2\tan x)dx.$$
设 $u=\tan x$，得：
$$=e^{2x}\tan x -\int 2e^{2x}\tan x dx +2\int e^{2x}\tan x dx.$$
化简得：
$$=e^{2x}\tan x+C.$$

### 3 已知 $f(x)$ 的一个原函数为 $\dfrac{\sin x}{x}$，求 $\displaystyle \int x f'(x)\,dx$

解答：
已知
$$F(x)=\frac{\sin x}{x}$$
是 $f(x)$ 的一个原函数，因此
$$F'(x)=f(x).$$
要求
$$\int x f'(x) dx.$$
对被积函数作分部积分，令
$$u=x,\quad dv=f'(x)\,dx,$$
则
$$du=dx,\quad v=f(x).$$
因此
$$\int x f'(x) dx= x f(x)-\int f(x)dx.$$
又因为
$$\int f(x)dx = F(x)=\frac{\sin x}{x}.$$
代入得
$$\int x f'(x) dx = x f(x)-\frac{\sin x}{x} + C.$$
而
$$f(x)=F'(x)=\left(\frac{\sin x}{x}\right)'=\frac{x\cos x-\sin x}{x^{2}}.$$
因此
$$x f(x)=\frac{x\cos x-\sin x}{x}.$$
最终：
$$\int x f'(x) dx=\frac{x\cos x-\sin x}{x}-\frac{\sin x}{x}+C$$
$$=\frac{x\cos x-2\sin x}{x}+C.$$

### 4 证明：若

$$I_n =\int \tan^{n} x\, dx\quad (n=2,3,\ldots),$$
则
$$I_n=\frac{1}{n-1}\tan^{\,n-1}x - I_{n-2}.$$
解答：
从
$$I_n=\int \tan^{n}x\, dx$$
开始，将被积函数拆出一项 $\tan^{n-2}x \tan^{2}x$：
$$I_n=\int \tan^{n-2}x \tan^{2}x\,dx.$$
利用恒等式
$$\tan^{2}x=\sec^{2}x -1,$$
得
$$I_n=\int \tan^{n-2}x (\sec^{2}x-1)\,dx$$
$$=\int \tan^{n-2}x \sec^{2}x\,dx - \int \tan^{n-2}x\,dx$$
$$=\int \tan^{n-2}x \sec^{2}x\,dx - I_{n-2}.$$
对第一项作变量代换：
令
$$u=\tan x,\quad du=\sec^{2}x\,dx,$$
则
$$\int \tan^{n-2}x \sec^{2}x\,dx=\int u^{\,n-2}\,du=\frac{u^{\,n-1}}{n-1}+C.$$
写回原变量：
$$\int \tan^{n-2}x \sec^{2}x\,dx=\frac{\tan^{\,n-1}x}{n-1}.$$
因此
$$I_n=\frac{1}{n-1}\tan^{\,n-1}x - I_{n-2} + C.$$
证毕。

## 三、考研真题

### 5 （2006216）$\displaystyle \int\frac{\arcsin(e^{x})}{e^{x}}dx$

解答：

令 $t=e^{x}$，则
$$\int\frac{\arcsin t}{t}dt.$$
分部积分：
$$=\arcsin t\ln t-\int\ln t\frac{1}{\sqrt{1-t^{2}}}dt.$$
进一步代换 $u=t^{2}$ 得：
$$=\arcsin(e^{x})\,x-\frac12\ln(1-e^{2x})+C.$$

### 6 （2003215）$\displaystyle \int \frac{x e^{\arctan x}}{(1+x^{2})^{3/2}}dx$

解答：

令 $u=\arctan x$，则 $du=\frac1{1+x^{2}}dx$，且$\sqrt{1+x^{2}}=\sec u$。
化简可得：
$$\int e^{u}\sin u\,du$$
$$=\frac12 e^{u}(\sin u-\cos u)+C.$$
写回 $x$：
$$=\frac12 e^{\arctan x}\left(\frac{x}{\sqrt{1+x^{2}}}-\frac{1}{\sqrt{1+x^{2}}}\right)+C.$$

### 7 （2011317）$\displaystyle \int \frac{\arcsin\sqrt{x}+\ln x}{\sqrt{x}}dx$

解答：

拆成两项：
$$\int \frac{\arcsin\sqrt{x}}{\sqrt{x}}dx+\int \frac{\ln x}{\sqrt{x}}dx.$$
第一项令 $u=\sqrt{x}$：
$$=2\int \frac{\arcsin u}{u}du=2(\arcsin u\ln u -\ln(u+\sqrt{1-u^{2}}))+C.$$
第二项：
$$\int x^{-1/2}\ln x dx=2\sqrt{x}\ln x-4\sqrt{x}.$$
合并即可得到最终表达式。

### 8 （2016102）函数

$$f(x)=
\begin{cases}
2(x-1), & x<1,\\
\ln x, & x\ge 1
\end{cases}$$
的一个原函数是（ ）

解答：

对 $x<1$:
$$F(x)=\int 2(x-1)dx=(x-1)^{2}+C_{1}.$$
对 $x\ge 1$:
$$F(x)=\int \ln x dx= x\ln x-x+C_{2}.$$
在 $x=1$ 处连续：
$$C_{1}=C_{2}.$$
匹配四个选项，可得正确形式为：
$$F(x)=
\begin{cases}
(x-1)^{2}, & x<1,\\
x(\ln x-1), & x\ge 1
\end{cases}$$
对应选项 A。
